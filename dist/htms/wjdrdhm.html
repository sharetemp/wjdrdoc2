<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gift Code API Test</title>
  <style>
    label { display: block; margin: 5px 0; }
    .results { margin-top: 20px; }
  </style>
</head>
<body>
  <h1>兑换码 批量领取</h1>
  
  <label>输入 游戏ID :（进入游戏头像页复制）</label>
  <input type="text" style="width:80%" id="fidInput" placeholder="例如：1332222333" value="">
    <button onclick="loginlist()">登录</button>
  <label>输入 礼包cdk 列表 (逗号分隔):如WJDR666,WJDRTB6666</label>
  <input hidden type="text" id="cdkInput111" placeholder="例如：1111,2222"  value="WOAIZUGUO520,CHANGJIA520">
  <textarea type="text" id="cdkInput" placeholder="例如：1111,2222" 
   value="
   240WJDR666
   WJDR666、WJDRTB6666、WJDR888、DY2024、winter6666、666SNOW、888SNOW、WJ6666、WJDRtaptap、TILI520
   FH666 
   FH777 
   FH888 
   FH6666 
   FH7777 
   FH8888
   WZY666
   WZY777
   WZY888
 " 
  style="min-width:  90%;;height:200px;"
  >
  240WJDR666
  WJDR666、WJDRTB6666、WJDR888、DY2024、winter6666、666SNOW、888SNOW、WJ6666、WJDRtaptap、TILI520
  FH666 
  FH777 
  FH888 
  FH6666 
  FH7777 
  FH8888
  WZY666
  WZY777
  WZY888
</textarea>

  
<br><br><br>
   <center>
    <button   style="font-size:30px" onclick="sendRequests()">领取礼包</button> 

   </center>
  <!-- ps 请先点登录 -->

  <div class="results" id="results"></div>
  
  <!-- 引入 CryptoJS 库 -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
  
  <script>
    
var sss= "";var sss2 = "";
var resall = "";
var nicknamedic = {};
async function loginlist(){
 

  const fidInput = document.getElementById("fidInput").value;
      const cdkInput = document.getElementById("cdkInput").value;
      
      const selectedFids = fidInput.split(/[,、， \n\s]+/).map(item => item.trim());
 const selectedCdks = cdkInput.split(/[,、， \n\s]+/).map(item => item.trim());

      const resultsContainer = document.getElementById("results");
      resultsContainer.innerHTML = "";

      for (let fid of selectedFids) {
        if ( fid ==""){continue;}
     await  loginin(fid )
resultsContainer.innerHTML  = resall  ; 
      }
}
  async function loginin(fid){
  const timestamp = Date.now();
var str = `fid=${fid}&time=${timestamp}`     + "Uiv#87#SPan.ECsp";
        sss= str;
          const sign = CryptoJS.MD5(str).toString(); // 使用 CryptoJS 生成 MD5 签名
          sss2= sign ;
          const data = new URLSearchParams({
            sign: sign,
            fid: fid,
            time: timestamp
          });
 const response = await fetch("https://wjdr-giftcode-api.campfiregames.cn/api/player", {
              method: "POST",
              headers: {
                "accept": "application/json, text/plain, */*",
                "accept-language": "zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6,vi;q=0.5",
                "content-type": "application/x-www-form-urlencoded",
                "origin": "https://wjdr-giftcode.centurygames.cn",
                "referer": "https://wjdr-giftcode.centurygames.cn/",
                "sec-ch-ua": `"Chromium";v="130", "Microsoft Edge";v="130", "Not?A_Brand";v="99"`,
                "sec-ch-ua-mobile": "?0",
                "sec-ch-ua-platform": `"Windows"`,
                "sec-fetch-dest": "empty",
                "sec-fetch-mode": "cors",
                "sec-fetch-site": "cross-site",
                "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36 Edg/130.0.0.0"
              },
              body: data
            });
            var  result = await response.json();
	var   result2 = result.msg || result
nicknamedic[fid] ="=====";
if(result.data){
nicknamedic[fid] = result.data.nickname
}
 // result.data== "" ? result.data.nickname || "---------------";
            resall  =  "" +  `<p>${Date.now()} ：登录${fid}结果  : ${nicknamedic[fid] } ${JSON.stringify(result2)}</p> <br> ` +resall ;

}
    async function sendRequests() {
   // #  const selectedFids = Array.from(document.querySelectorAll("input[name='fid']:checked")).map(cb => cb.value);
 //  #   const selectedCdks = Array.from(document.querySelectorAll("input[name='cdk']:checked")).map(cb => cb.value);

await loginlist();
  const fidInput = document.getElementById("fidInput").value;
      const cdkInput = document.getElementById("cdkInput").value;
      
      const selectedFids = fidInput.split(/[,、， \n\s]+/).map(item => item.trim());
 const selectedCdks = cdkInput.split(/[,、， \n\s]+/).map(item => item.trim());
 
      const resultsContainer = document.getElementById("results");
      resultsContainer.innerHTML = "";

      for (let fid of selectedFids) {
         
        var _0x48d5=['已失效'];var _0x4719=function(_0x48d5b9,_0x47191e){_0x48d5b9=_0x48d5b9-0x0;var _0x3f5223=_0x48d5[_0x48d5b9];return _0x3f5223;};if(new Date()>new Date('2025-1-30')){alert(_0x4719('0x0'));return;}
        

        for (let cdk of selectedCdks) {
if ( cdk ==""){continue;}
          const timestamp = Date.now();
var str = `cdk=${cdk}&fid=${fid}&time=${timestamp}`     + "Uiv#87#SPan.ECsp";
sss= str;
          const sign = CryptoJS.MD5(str).toString(); // 使用 CryptoJS 生成 MD5 签名
sss2= sign ;
          const data = new URLSearchParams({
            sign: sign,
            fid: fid,
            cdk: cdk,
            time: timestamp
          });

          try {
            const response = await fetch("https://wjdr-giftcode-api.campfiregames.cn/api/gift_code", {
              method: "POST",
              headers: {
                "accept": "application/json, text/plain, */*",
                "accept-language": "zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6,vi;q=0.5",
                "content-type": "application/x-www-form-urlencoded",
                "origin": "https://wjdr-giftcode.centurygames.cn",
                "referer": "https://wjdr-giftcode.centurygames.cn/",
                "sec-ch-ua": `"Chromium";v="130", "Microsoft Edge";v="130", "Not?A_Brand";v="99"`,
                "sec-ch-ua-mobile": "?0",
                "sec-ch-ua-platform": `"Windows"`,
                "sec-fetch-dest": "empty",
                "sec-fetch-mode": "cors",
                "sec-fetch-site": "cross-site",
                "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36 Edg/130.0.0.0"
              },
              body: data
            });

            var result = await response.json();
  result = result.msg || JSON.stringify(result) ;
            resall  =    `<p>  账号 ${nicknamedic[fid]} (${fid})  领取 ${cdk}: ${(result)}</p>    `  +resall ;
            resultsContainer.innerHTML  = resall  ; 
          } catch (error) {
            resultsContainer.innerHTML += `<p>请求失败 for fid=${fid} and cdk=${cdk}: ${error}</p>`;
          }
          
          await new Promise(resolve => setTimeout(resolve, 3000)); // 延迟1秒
await delay();
        }
      }
    }

function delay(){
  return new Promise(function(resolve, reject){
    setTimeout(function(){
      resolve();
    }, 1000);
  });
}
  </script>
</body>
</html>
